---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import Header from '../components/Header';
import ArticleGrid from '../components/ArticleGrid.astro';

// Fetch all articles from content collection
const articles = await getCollection('articles');

// Sort articles by published date (newest first)
const sortedArticles = articles.sort((a, b) => {
  const dateA = new Date(a.data.publishedOn || 0);
  const dateB = new Date(b.data.publishedOn || 0);
  return dateB.getTime() - dateA.getTime();
});
---

<Layout>
  <main class="min-h-screen bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <Header 
        title="Articles" 
        subtitle="Journal of the mental environment" 
        navigationText="Browse Spoof Ads" 
        navigationHref="/spoof-ads" 
        client:load 
      />
      
      <ArticleGrid articles={sortedArticles} />
    </div>
  </main>
</Layout>

