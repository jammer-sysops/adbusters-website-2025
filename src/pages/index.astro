---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import Header from '../components/Header';
import Section from '../components/Section';
import ArticleGrid from '../components/ArticleGrid.astro';

// Fetch latest 6 articles for homepage
const articles = await getCollection('articles');

// Sort articles by published date (newest first) and take first 6
const sortedArticles = articles.sort((a, b) => {
  const dateA = new Date(a.data.publishedOn || 0);
  const dateB = new Date(b.data.publishedOn || 0);
  return dateB.getTime() - dateA.getTime();
}).slice(0, 6);
---

<Layout>
	<main class="min-h-screen bg-white">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
			<Header 
				navigationText="Browse Spoof Ads" 
				navigationHref="/spoof-ads" 
				client:load 
			/>
			
			<Section title="Latest Articles" viewAllLink="/articles" viewAllText="View all articles â†’" client:load>
				<ArticleGrid articles={sortedArticles} />
			</Section>
		</div>
	</main>
</Layout>

